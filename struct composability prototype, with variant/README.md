Interesting design with variants!

(untested, could have bugs so don't use)